<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <title>FitSense AI</title>
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js" crossorigin="anonymous"></script>
    <script defer src="script.js"></script>
  </head>
  <body>
    <div class="app-shell">
      
      <header class="ios-header">
        <h1 id="page-title">Übersicht</h1>
        <div class="header-status">
          <span class="status-indicator" id="ai-status">KI bereit</span>
          <div class="user-avatar" data-nav-target="profile">
            <svg width="20" height="20" fill="currentColor" viewBox="0 0 24 24"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
          </div>
        </div>
      </header>

      <main>
        <section id="dashboard" class="view active">
          <div class="date-header">
            <span id="current-date">Heute</span>
          </div>

          <div class="ios-card activity-card">
            <div class="activity-rings">
              <div class="ring-container">
                <div class="ring ring-red"></div>
                <div class="ring ring-green"></div>
                <div class="ring ring-blue"></div>
                <div class="ring-stats">
                  <div class="big-stat" id="streak-score">0</div>
                  <div class="stat-label">Tage Streak</div>
                </div>
              </div>
              <div class="activity-legend">
                <div class="legend-item red">
                  <span class="val" id="today-calories">0</span> <span class="unit">kcal</span>
                </div>
                <div class="legend-item green">
                  <span class="val" id="today-reps">0</span> <span class="unit">Wdh</span>
                </div>
                <div class="legend-item blue">
                  <span class="val" id="tech-score">0%</span> <span class="unit">Technik</span>
                </div>
              </div>
            </div>
          </div>

          <div class="ios-grid-2">
            <button class="action-card color-green" data-nav-target="training">
              <div class="icon-circle">
                <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M13 10V3L4 14h7v7l9-11h-7z"/></svg>
              </div>
              <span>Training</span>
            </button>
            <button class="action-card color-orange" data-nav-target="nutrition">
               <div class="icon-circle">
                <svg width="24" height="24" fill="none" stroke="currentColor" stroke-width="2.5" viewBox="0 0 24 24"><path d="M3 6l3 1m0 0l-3 9a5.002 5.002 0 006.001 0M6 7l3 9M6 7l6-2m6 2l3-1m-3 1l-3 9a5.002 5.002 0 006.001 0M18 7l3 9m-3-9l-6-2m0-2v2m0 16V5m0 16H9m3 0h3"/></svg>
               </div>
              <span>Food Scan</span>
            </button>
          </div>

          <div class="ios-section-title">Status</div>
          <div class="ios-list-group">
            <div class="ios-list-item">
              <div class="icon-box blue-bg">
                <svg width="18" height="18" fill="white" viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
              </div>
              <div class="content">
                <div class="label">Regeneration</div>
                <div class="value muted" id="recovery-hint">Bereit</div>
              </div>
            </div>
            <div class="ios-list-item">
               <div class="icon-box orange-bg">
                <svg width="18" height="18" fill="white" viewBox="0 0 24 24"><path d="M11 9H9V2H7v7H5V2H3v7c0 2.12 1.66 3.84 3.75 3.97V22h2.5v-9.03C11.34 12.84 13 11.12 13 9V2h-2v7zm5-3v8h2.5v8H21V2c-2.76 0-5 2.24-5 4z"/></svg>
              </div>
              <div class="content">
                <div class="label">Protein heute</div>
                <div class="value muted" id="today-protein">0 g</div>
              </div>
            </div>
          </div>

          <div class="ios-section-header">
            <h3>Letzte Aktivitäten</h3>
            <button class="link-btn" data-nav-target="training">Alle</button>
          </div>
          <div id="recent-activity" class="ios-list-group"></div>
        </section>

        <section id="training" class="view">
          <div class="ios-card camera-container">
            <div class="camera-header-overlay">
              <select id="exercise-select" class="glass-select">
                <option value="Kniebeugen">Kniebeugen</option>
                <option value="Liegestütze">Liegestütze</option>
                <option value="Kreuzheben">Kreuzheben</option>
                <option value="Rows">Rows</option>
              </select>
               <select id="camera-facing" class="glass-select icon-only">
                <option value="environment">back</option>
                <option value="user">front</option>
              </select>
            </div>
            
            <div class="video-wrapper">
               <video id="camera-feed" playsinline muted></video>
               <canvas id="skeleton-canvas"></canvas>
            </div>

            <div class="camera-footer-overlay">
               <div class="status-badge" id="camera-status">Kamera inaktiv</div>
               <div class="feedback-area" id="training-feedback">
                  <h3>Startbereit</h3>
                  <p>Platziere dein Handy stabil</p>
               </div>
               
               <div class="metrics-row">
                 <div class="metric">
                   <span class="label">Wiederholungen</span>
                   <span class="val-huge" id="rep-count">0</span>
                 </div>
                 <div class="metric">
                   <span class="label">Tempo</span>
                   <span class="val-small" id="tempo-info">—</span>
                 </div>
               </div>
            </div>
          </div>

          <div class="control-bar">
            <button class="ios-btn-green" id="start-training">Start</button>
            <button class="ios-btn-gray" id="pause-training">Pause</button>
            <button class="ios-btn-blue" id="save-set">Speichern</button>
            <button class="ios-btn-red icon-only" id="stop-training">✕</button>
          </div>

          <div class="ios-section-title">Heutige Sätze</div>
          <div id="sets-list" class="ios-list-group"></div>
          
           <div class="ios-section-title">Pose Replay</div>
           <div class="ios-card" style="padding:0;">
             <div class="block-header" style="padding: 12px 16px;">
                 <span>Letzte Analyse</span>
                 <button class="link-btn" id="play-replay">Abspielen</button>
             </div>
             <div id="replay-log" style="padding: 0 16px 16px 16px;"></div>
           </div>
        </section>

        <section id="nutrition" class="view">
          <div class="ios-card scanner-hero">
            <label class="file-upload-overlay">
               <input type="file" id="food-input" accept="image/*" capture="environment" />
               <div class="camera-icon-large">
                 <svg width="40" height="40" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path d="M3 9a2 2 0 012-2h.93a2 2 0 001.664-.89l.812-1.22A2 2 0 0110.07 4h3.86a2 2 0 011.664.89l.812 1.22A2 2 0 0018.07 7H19a2 2 0 012 2v9a2 2 0 01-2 2H5a2 2 0 01-2-2V9z"/><path d="M15 13a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
                 <span>Foto aufnehmen</span>
               </div>
            </label>
            <div class="preview-area">
               <img id="food-preview" />
            </div>
          </div>

          <div class="slider-container ios-list-item" style="margin-top: 16px; border-radius: 12px;">
             <span>Portion</span>
             <input type="range" id="portion-slider" min="0.5" max="2" step="0.1" value="1" class="ios-slider"/>
          </div>

          <div id="food-details" class="ios-card info-box" style="margin-top: 16px;">
            <p class="muted">Scanne eine Mahlzeit für KI-Analyse</p>
          </div>
          <button class="ios-btn-full ios-btn-blue" id="save-food" style="margin-top: 16px;">Hinzufügen</button>

          <div id="nutrition-progress-card" class="ios-card" style="margin-top: 24px; display: none;">
             <h3>Tagesfortschritt</h3>
             <div id="nutrition-progress" class="progress-stack"></div>
           </div>

          <div class="ios-section-title">Rechner</div>
          <div class="ios-card">
            <form id="calorie-calculator-form">
               <div class="form-row">
                 <label>Ziel</label>
                 <select id="calc-goal" class="ios-input"><option value="maintain">Halten</option><option value="cut">Abnehmen</option><option value="bulk">Aufbau</option></select>
               </div>
               <div class="form-row split">
                 <input type="number" id="calc-weight" placeholder="kg" value="75" class="ios-input">
                 <input type="number" id="calc-height" placeholder="cm" value="178" class="ios-input">
               </div>
               <div style="display:none;">
                  <select id="calc-gender"><option value="divers">Divers</option></select>
                  <input id="calc-age" value="25">
                  <select id="calc-activity"><option value="moderate">Mittel</option></select>
               </div>
               <button type="submit" class="link-btn" style="margin-top:10px;">Neu berechnen</button>
            </form>
            <div id="calorie-results" style="margin-top:10px;"></div>
          </div>

          <div class="ios-section-title">Logbuch</div>
          <div id="food-log" class="ios-list-group"></div>
        </section>

        <section id="plan" class="view">
           <div class="ios-card accent-card">
              <h2>Dein KI Plan</h2>
              <p class="muted" id="plan-summary">Wird geladen...</p>
           </div>
           
           <form id="plan-form" class="ios-card hidden-form">
              <input type="hidden" id="age" value="25"><input type="hidden" id="gender" value="männlich">
              <input type="hidden" id="height" value="180"><input type="hidden" id="weight" value="80">
              <div class="form-row">
                 <label>Level</label>
                 <select id="level" class="ios-input"><option value="anfänger">Anfänger</option><option value="fortgeschritten">Fortgeschritten</option></select>
              </div>
              <div class="form-row">
                 <label>Geräte</label>
                 <select id="equipment" class="ios-input"><option value="körpergewicht">Bodyweight</option><option value="kurzhanteln">Kurzhanteln</option><option value="studio">Gym</option></select>
              </div>
               <div class="form-row">
                 <label>Ziel</label>
                 <select id="goal" class="ios-input"><option value="aufbau">Muskeln</option><option value="fatloss">Definition</option></select>
              </div>
              <div class="form-row">
                 <label>Tage/Woche</label>
                 <input type="number" id="frequency" value="3" class="ios-input">
              </div>
              <button class="ios-btn-full ios-btn-blue" type="submit" style="margin-top:12px;">Plan aktualisieren</button>
           </form>

           <div class="ios-section-title">Wochenübersicht</div>
           <div id="plan-days" class="ios-list-group"></div>
           <div id="next-session" style="display:none;"></div> </section>

        <section id="profile" class="view">
           <div class="ios-section-title">Einstellungen</div>
           <div class="ios-list-group">
              <div class="ios-list-item">
                 <span>Kamera Zugriff</span>
                 <input type="checkbox" id="camera-consent" class="ios-switch">
              </div>
              <div class="ios-list-item">
                 <span>Benachrichtigungen</span>
                 <input type="checkbox" id="notification-toggle" checked class="ios-switch">
              </div>
               <div class="ios-list-item">
                 <span>Apple Watch / Wearable</span>
                 <input type="checkbox" id="wearable-toggle" class="ios-switch">
              </div>
           </div>
           <p class="legal-text">FitSense AI speichert keine Videos. Analyse erfolgt lokal/temporär.</p>
        </section>

      </main>

      <nav class="ios-tab-bar">
        <button class="tab-btn active" data-target="dashboard">
          <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/></svg>
          <span>Übersicht</span>
        </button>
        <button class="tab-btn" data-target="training">
          <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 5.57 2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22 14.86 20.57 17 22.71 19.14 20.57 20.57 19.14 22.71 17z"/></svg>
          <span>Training</span>
        </button>
        <button class="tab-btn" data-target="nutrition">
          <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M11 9H9V2H7v7H5V2H3v7c0 2.12 1.66 3.84 3.75 3.97V22h2.5v-9.03C11.34 12.84 13 11.12 13 9V2h-2v7zm5-3v8h2.5v8H21V2c-2.76 0-5 2.24-5 4z"/></svg>
          <span>Essen</span>
        </button>
        <button class="tab-btn" data-target="plan">
          <svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24"><path d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
          <span>Plan</span>
        </button>
      </nav>
    </div>
  </body>
</html>
